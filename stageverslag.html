<!DOCTYPE html>
<html>
<head>
<title>GIP website J. Swaelen</title>
<link rel="icon" type="image" href="img/favicon.ico" />
<script src="script.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Bangers|Oswald" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/pure/0.6.0/pure-min.css">
<link rel="stylesheet" href="balloon.css">
<link rel="stylesheet" href="main.css">
<script src="https://use.fontawesome.com/8b162ad928.js"></script>
</head>

<body>
<header>
	<h1 id="headerGip-Text" class="snow">GIP-website <div id="profielFoto" data-balloon="Welkom!" data-balloon-pos="left"></div>Jelle Swaelen</h1>
</header>
    
<div class="pure-g middenGip">
	<div class="pure-u-1-3 middenGip-menu">
        <p><a href=index.html>HOME</a></p>
	</div>
    <div class="pure-u-1-3 middenGip-menu-selected">
        <p><a>STAGEVERSLAG</a></p>
	</div>
	<div class="pure-u-1-3 middenGip-menu">
        <p><a href=taken.html>INFO</a></p>
	</div>
</div>

<div class="pure-g middenGip">
<div id="vergrootVerklein4" onclick="vergrootVerklein(this.id)" class="pure-u-1 middenGip-1-4-taak">
		<h1><i class="fa fa-arrow-down" aria-hidden="true"></i> 2017-01-16 <i class="fa fa-arrow-down" aria-hidden="true"></i></h1>
		<p>Uitleg over algemene taak:<br>Soort script schrijven dat elke dag van de webpagina samen met de database een backup maakt. Hosting gebeurt op Plesk en de backup zou opgeslagen moeten worden op Amazon S3.<br><br>Geïnstalleerde tools hiervoor:<br>Putty, dit is het programma dat je een console geeft waarmee je aanpassingen kan maken op je Plesk host.<br><br>AWS Command Line Interface (CLI) geïnstalleerd en een gebruiker geconfigureerd:<br>Gebruikte tool => Putty.<br><br>Informatie opgezocht over de mogelijke manieren om een backup te maken van alle website documenten</p>
	</div>
    <div id="vergrootVerklein5" onclick="vergrootVerklein(this.id)" class="pure-u-1 middenGip-1-4-taak">
		<h1><i class="fa fa-arrow-down" aria-hidden="true"></i> 2017-01-17 <i class="fa fa-arrow-down" aria-hidden="true"></i></h1>
        <p>Verder gezocht naar een oplossing voor de code.<br><br>Niet alles kan in één keer gedaan worden, zoals de code hierboven. Om de backup te verplaatsen van de SSH en dan door te sturen naar de AWS cloud, moet er met meerdere stappen gewerkt worden.<br><br>Zippen van de mappen met essentiële bestanden en exporteren van database op de host.<br><br>http-bestanden:<br><code>tar -zcv sitebackup_blockpress.io_"datum".tar.gz /var/www/vhosts/blockpress.io/httpdocs</code><br><br>database:<br>[NIETS VOOR GEVONDEN VANDAAG]<br><br>Het gezipte bestand van de host naar de desktop van de lokale computer sturen.<br><br>http-bestanden:<br><code>pscp jelle@jelle.wappla.com:/var/www/_backups/sitebackup_blockpress.io_2017-01-16.tar %USERPROFILE%\Desktop</code><br><br>database:<br><code>pscp jelle@jelle.wappla.com:/var/www/_backups/naamBackup.sql %USERPROFILE%\Desktop</code><br><br>De database en het gezipte bestand met alle http bestanden uploaden naar de AWS.<br><br>http-bestanden:<br><code>aws s3 cp sitebackup_blockpress.io_”datum”.tar s3://wappla-jelle-backups</code><br><br>database:<br><code>aws s3 cp wordpress_e.sql s3://wappla-jelle-backups</code></p>
	</div>
    <div id="vergrootVerklein6" onclick="vergrootVerklein(this.id)" class="pure-u-1 middenGip-1-4-taak">
		<h1><i class="fa fa-arrow-down" aria-hidden="true"></i> 2017-01-18 <i class="fa fa-arrow-down" aria-hidden="true"></i></h1><p>Oplossing voor exporteren database gevonden:<br><br>Fout wachtwoord en username gebruikt, juiste naam en password gevonden in:<br>blockpress.io/httpdocs/wp-config.php => Op het server web paneel<br><br>USERNAME: root => wordpress_2<br>PASSWORD: mAXtsgEZ => f5SyA82#Tb<br><br>Werkende code die de database exporteert naar de backup map:<br><code>mysqldump -u wordpress_2 -pf5SyA82#Tb wordpress_e > /var/www/_backups/db_backup_”datum”.sql</code><br><br>Verder zoeken naar een manier om van alle apart werkende code één geheel te maken:<br><br>Maken van een script dat uitgevoerd kan worden op de Linux server.<br><br>scriptNaam.sh => Naam van een script-file op Linux<br>! => Execute rechten aanpassen zodat iedereen het kan uitvoeren.<br><br>chmod 755 fileName => Hiermee geef je iedereen rechten het bestand uit te voeren en te lezen en geef je de eigenaar ook rechten het bestand te veranderen.<br>Bestand aanmaken kan simpelweg met “touch test.sh”<br><br>Parameters: DomainName, UserName, UserPassword en dbName<br><br>Code om de datum van vandaag in een variabele te krijgen en af te printen:<br><code>CurrentDate=$(date +%D)<br>
        echo “$CurrentDate”</code><br>=> Bv.: 01/18/17 notatie is dus: MM/DD/YY<br><br>UPDATE: 2017-01-20 Deze notatie zorgde voor fouten, “/” verandert in “-”.<br><code>CurrentDate=$(date +%Y-%m-%d)</code><br>=> Bv.: 01-20-2017 notatie is nu: MM-DD-YYYY</p>
	</div>
    <div id="vergrootVerklein7" onclick="vergrootVerklein(this.id)" class="pure-u-1 middenGip-1-4-taak">
		<h1><i class="fa fa-arrow-down" aria-hidden="true"></i> 2017-01-19 <i class="fa fa-arrow-down" aria-hidden="true"></i></h1><p>Debugging script:<br><br><code>zip -r backup_blockpress.io_2017-01-19.zip /var/www/vhosts/blockpress.io/httpdocs/</code><br>=> Werkt als het apart op de command line wordt ingegeven, niet in script.<br><br><code>!#/bin/bash<br><br>DomainName=$1<br>zip -r /var/www/_backups/backup_${DomainName}_datum.zip /var/www/vhosts/${DomainName}/httpdocs/</code><br>=> Wanneer de variabele van de datum niet wordt meegegeven aan de naam van het gezipt bestand, werkt het script.<br><br><code>!#/bin/bash<br><br>DomainName=$1<br>dbUserName=$2<br>dbPassword=$3<br>dbName=$4<br>zip -r /var/www/_backups/backup_${DomainName}_datum.zip /var/www/vhosts/${DomainName}/httpdocs/<br>mysqldump -u $dbUserName -p${dbPassword} $dbName > /var/www/_backups/db_backup_datum.sql</code><br>=> Als een variabele deel uitmaakt van een string, gebruik je: ${naamVar}, enkel de waarde van de variabele zonder links/rechts tekst toe te voegen: $naamVar<br><br>=> Nog steeds geen variabele met de datum van de dag die kan worden meegegeven, maar het exporteren van de database met de variabelen werkt.</p>
	</div>
    <div id="vergrootVerklein8" onclick="vergrootVerklein(this.id)" class="pure-u-1 middenGip-1-4-taak">
		<h1><i class="fa fa-arrow-down" aria-hidden="true"></i> 2017-01-20 <i class="fa fa-arrow-down" aria-hidden="true"></i></h1><p>AWS S3 geïnstalleerd en geconfigureerd op SSH server. (Enkel op user)<br><br>aws locatie: /root/bin/aws<br>Om alle “buckets” weer te geven: ./aws s3 ls<br><br><code>!#/bin/bash<br><br>DomainName=$1<br>dbUserName=$2<br>dbPassword=$3<br>dbName=$4<br>BucketName=$5<br>CurrentDate=$(date +%Y-%m-%d)<br>zip -r /var/www/_backups/backup_${DomainName}_${CurrentDate}.zip/var/www/vhosts/${DomainName}/httpdocs/<br>mysqldump -u $dbUserName -p${dbPassword} $dbName > /var/www/_backups/db_backup_${CurrentDate}.sql<br>/root/bin/aws s3 cp /var/www/_backups/backup_${DomainName}_${CurrentDate}.zip s3://wappla-jelle-backups<br>/root/bin/aws s3 cp /var/www/_backups/db_backup_${CurrentDate}.sql s3://${BucketName}<br></code>Bovenstaand script werkt => Mijn fout was dat ik als datum notatie .../.../… gebruikte, in Linux wordt “/” gebruikt om een pad mee te geven wat zorgde voor fouten.<br><br>Alle bestanden en onderliggende mappen in “httpdocs” worden correct gezipt en de database wordt ook op de juiste manier geëxporteerd. Beide bestanden worden daarna geüpload naar de juiste bucket.</p>
	</div>
</div>
    
<footer id="footerGip">
	<p id="footerGip-Text">GIP website&nbsp;2016</p>
</footer>
</body>
</html>
